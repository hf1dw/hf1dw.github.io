<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="CTF,攻防世界,">










<meta name="description" content="####0x01 base64元宵节灯谜是一种古老的传统民间观灯猜谜的习俗。 因为谜语能启迪智慧又饶有兴趣，灯谜增添节日气氛，是一项很有趣的活动。 你也很喜欢这个游戏，这不，今年元宵节，心里有个黑客梦的你，约上你青梅竹马的好伙伴小鱼， 来到了cyberpeace的攻防世界猜谜大会，也想着一展身手。 你们一起来到了小孩子叽叽喳喳吵吵闹闹的地方，你俩抬头一看，上面的大红灯笼上写着一些奇奇怪怪的 字符串">
<meta name="keywords" content="CTF,攻防世界">
<meta property="og:type" content="article">
<meta property="og:title" content="攻防世界--crypto--新手区">
<meta property="og:url" content="http://yoursite.com/2019/09/14/CTF/攻防世界--crypto--新手区/index.html">
<meta property="og:site_name" content="hf1dw&#39;s blogs">
<meta property="og:description" content="####0x01 base64元宵节灯谜是一种古老的传统民间观灯猜谜的习俗。 因为谜语能启迪智慧又饶有兴趣，灯谜增添节日气氛，是一项很有趣的活动。 你也很喜欢这个游戏，这不，今年元宵节，心里有个黑客梦的你，约上你青梅竹马的好伙伴小鱼， 来到了cyberpeace的攻防世界猜谜大会，也想着一展身手。 你们一起来到了小孩子叽叽喳喳吵吵闹闹的地方，你俩抬头一看，上面的大红灯笼上写着一些奇奇怪怪的 字符串">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9223646-a2088b5d18b8d38a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9223646-769cbef2308676b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/9223646-8e098c3a535e7a0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-09-14T08:26:06.678Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="攻防世界--crypto--新手区">
<meta name="twitter:description" content="####0x01 base64元宵节灯谜是一种古老的传统民间观灯猜谜的习俗。 因为谜语能启迪智慧又饶有兴趣，灯谜增添节日气氛，是一项很有趣的活动。 你也很喜欢这个游戏，这不，今年元宵节，心里有个黑客梦的你，约上你青梅竹马的好伙伴小鱼， 来到了cyberpeace的攻防世界猜谜大会，也想着一展身手。 你们一起来到了小孩子叽叽喳喳吵吵闹闹的地方，你俩抬头一看，上面的大红灯笼上写着一些奇奇怪怪的 字符串">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/9223646-a2088b5d18b8d38a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/09/14/CTF/攻防世界--crypto--新手区/">





  <title>攻防世界--crypto--新手区 | hf1dw's blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>
	<a href="https://github.com/hf1dw"><img width="100" height="100" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hf1dw's blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">studying,reading,thinking</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/CTF/攻防世界--crypto--新手区/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">攻防世界--crypto--新手区</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T17:49:46+08:00">
                2019-09-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index">
                    <span itemprop="name">CTF</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/crypto/" itemprop="url" rel="index">
                    <span itemprop="name">crypto</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>####0x01 base64<br>元宵节灯谜是一种古老的传统民间观灯猜谜的习俗。 因为谜语能启迪智慧又饶有兴趣，灯谜增添节日气氛，是一项很有趣的活动。 你也很喜欢这个游戏，这不，今年元宵节，心里有个黑客梦的你，约上你青梅竹马的好伙伴小鱼， 来到了cyberpeace的攻防世界猜谜大会，也想着一展身手。 你们一起来到了小孩子叽叽喳喳吵吵闹闹的地方，你俩抬头一看，上面的大红灯笼上写着一些奇奇怪怪的 字符串，小鱼正纳闷呢，你神秘一笑，我知道这是什么了。</p>
<a id="more"></a>
<p><a href="https://baike.baidu.com/item/base64/8545775?fr=aladdin" target="_blank" rel="noopener">base64</a>解密即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#!/user/bin/env python</span><br><span class="line"># -*-coding:utf-8 -*-</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">a = open(r&apos;crypto1.txt&apos;,&apos;r&apos;)</span><br><span class="line">s = a.read()</span><br><span class="line"></span><br><span class="line">print(base64.b64decode(s))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;Welcome_to_new_World!&#125;</span><br></pre></td></tr></table></figure>

<p>####0x02 Caesar<br>你成功的解出了来了灯谜，小鱼一脸的意想不到“没想到你懂得这么多啊！” 你心里面有点小得意，“那可不是，论学习我没你成绩好轮别的我知道的可不比你少，走我们去看看下一个” 你们继续走，看到前面也是热热闹闹的，同样的大红灯笼高高挂起，旁边呢好多人叽叽喳喳说个不停。你一看 大灯笼，上面还是一对字符，你正冥思苦想呢，小鱼神秘一笑，对你说道，我知道这个的答案是什么了</p>
<p><a href="https://baike.baidu.com/item/%E5%87%AF%E6%92%92%E7%A0%81/8993595" target="_blank" rel="noopener">凯撒码</a>解密即可<br><a href="https://www.cnblogs.com/ECJTUACM-873284962/p/8639300.html" target="_blank" rel="noopener">参考</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/user/bin/env python</span><br><span class="line"># -*-coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">a = open(r&apos;crypto2.txt&apos;,&apos;r&apos;)</span><br><span class="line">ciphertext = a.read()</span><br><span class="line">b=&apos;abcdefghijklmnopqrstuvwxyz&apos;</span><br><span class="line"></span><br><span class="line">for key in range(26):</span><br><span class="line">    flag = &apos;&apos;</span><br><span class="line">    for i in ciphertext:</span><br><span class="line">        if i in b:</span><br><span class="line">            num = b.find(i)</span><br><span class="line">            num = num - key</span><br><span class="line"></span><br><span class="line">            if num&lt;0:</span><br><span class="line">                num = num + len(b)</span><br><span class="line">            flag = flag + b[num]</span><br><span class="line">        else:</span><br><span class="line">            flag = flag + i</span><br><span class="line">    print(&apos;key %s :%s&apos;%(key,flag))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;you_have_learned_caesar_encryption&#125;</span><br></pre></td></tr></table></figure>

<p>####0x03 Morse<br>小鱼得意的瞟了你一眼，神神气气的拿走了答对谜语的奖励，你心里暗暗较劲 想着下一个谜题一定要比小鱼更快的解出来。不知不觉你们走到了下一个谜题的地方，这个地方有些奇怪。 上面没什么提示信息，只是刻着一些0和1，感觉有着一些奇怪的规律，你觉得有些熟悉，但是就是想不起来 这些01代表着什么意思。一旁的小鱼看你眉头紧锁的样子，扑哧一笑，对你讲“不好意思我又猜到答案了。”(flag格式为cyberpeace{xxxxxxxxxx},均为小写)</p>
<p>1变为<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[参考](http://blog.topspeedsnail.com/archives/2245)</span><br></pre></td></tr></table></figure></p>
<p>#!/usr/bin/env python3</p>
<h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding:utf-8 --"></a>-<em>- coding:utf-8 -</em>-</h1><p>CODE_TABLE = {<br>    # 26 个英文字符<br>    ‘A’: ‘.-‘, ‘B’: ‘-…’, ‘C’: ‘-.-.’,<br>    ‘D’: ‘-..’, ‘E’: ‘.’, ‘F’: ‘..-.’,<br>    ‘G’: ‘–.’, ‘H’: ‘….’, ‘I’: ‘..’,<br>    ‘J’: ‘.—‘, ‘K’: ‘-.-‘, ‘L’: ‘.-..’,<br>    ‘M’: ‘–’, ‘N’: ‘-.’, ‘O’: ‘—‘,<br>    ‘P’: ‘.–.’, ‘Q’: ‘–.-‘, ‘R’: ‘.-.’,<br>    ‘S’: ‘…’, ‘T’: ‘-‘, ‘U’: ‘..-‘,<br>    ‘V’: ‘…-‘, ‘W’: ‘.–’, ‘X’: ‘-..-‘,<br>    ‘Y’: ‘-.–’, ‘Z’: ‘–..’,<br><br>    # 10 个数字<br>    ‘0’: ‘—–’, ‘1’: ‘.—-‘, ‘2’: ‘..—‘,<br>    ‘3’: ‘…–’, ‘4’: ‘….-‘, ‘5’: ‘…..’,<br>    ‘6’: ‘-….’, ‘7’: ‘–…’, ‘8’: ‘—..’,<br>    ‘9’: ‘—-.’,<br><br>    # 16 个特殊字符<br>    ‘,’: ‘–..–’, ‘.’: ‘.-.-.-‘, ‘:’: ‘—…’, ‘;’: ‘-.-.-.’,<br>    ‘?’: ‘..–..’, ‘=’: ‘-…-‘, “‘“: ‘.—-.’, ‘/‘: ‘-..-.’,<br>    ‘!’: ‘-.-.–’, ‘-‘: ‘-….-‘, ‘_’: ‘..–.-‘, ‘(‘: ‘-.–.’,<br>    ‘)’: ‘-.–.-‘, ‘$’: ‘…-..-‘, ‘&amp;’: ‘. . . .’, ‘@’: ‘.–.-.’<br><br>    # 你还可以自定义</p>
<p>}</p>
<p>def morsedecode(morse):<br>    msg =’’<br>    codes = morse.split(‘ ‘)<br>    for code in codes:<br>        if code ==’’:<br>            msg += ‘ ‘<br>        else:<br>            UNCODE =dict(map(lambda t:(t[1],t[0]),CODE_TABLE.items()))<br>            msg += UNCODE[code]<br>    return msg</p>
<p>a = open(r’crypto3.txt’,’r’)<br>ciphertext = a.read()</p>
<p>ciphertext = ciphertext.replace(‘1’,’-‘)<br>ciphertext = ciphertext.replace(‘0’,’.’)</p>
<p>FLAG = morsedecode(ciphertext)<br>flag = FLAG.lower()<br>flag = ‘cyberpeace{‘+flag+’}’<br>print(‘flag is ‘,flag)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">cyberpeace&#123;morsecodeissointeresting&#125;</span><br></pre></td></tr></table></figure>

<p>####0x04 Railfence<br>被小鱼一连将了两军，你心里更加不服气了。两个人一起继续往前走， 一路上杂耍卖艺的很多，但是你俩毫无兴趣，直直的就冲着下一个谜题的地方去了。 到了一看，这个谜面看起来就已经有点像答案了样子了，旁边还画着一张画，是一副农家小院的 图画，上面画着一个农妇在栅栏里面喂5只小鸡，你嘿嘿一笑对着小鱼说这次可是我先找到答案了。</p>
<p>题目直接提示为<a href="https://baike.baidu.com/item/%E6%A0%85%E6%A0%8F%E5%AF%86%E7%A0%81/228209?fr=aladdin" target="_blank" rel="noopener">栅栏密码</a><br>对于<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">a = open(r&apos;crypto4.txt&apos;,&apos;r&apos;)</span><br><span class="line">ciphertext = a.read()</span><br><span class="line">b = len(ciphertext)</span><br><span class="line"></span><br><span class="line">print(&apos;The ciphertext :&apos;,ciphertext)</span><br><span class="line">print(&apos;The length of ciphertext is&apos;,b)</span><br><span class="line"></span><br><span class="line"># 将字符串转化为数组形式</span><br><span class="line">ciphertext = [ciphertext[i:i+1] for i in range(0,b,1)]</span><br><span class="line"></span><br><span class="line"># 获取可以解密的栅栏数</span><br><span class="line">c =[]</span><br><span class="line">num = 1</span><br><span class="line">while num &lt;= b:</span><br><span class="line">    if b%num == 0:</span><br><span class="line">        c.append(num)</span><br><span class="line">    else:</span><br><span class="line">        pass</span><br><span class="line">    num += 1</span><br><span class="line">print(&apos;每栏个数可为:&apos;,c)</span><br><span class="line"># 将密文按照栅栏数进行分组</span><br><span class="line">for step in c:</span><br><span class="line">    d = [ciphertext[i:i+step] for i in range(0,b,step)]</span><br><span class="line">    flag = &apos;&apos;</span><br><span class="line">    for i in range(step):</span><br><span class="line">        for x in d:</span><br><span class="line">            e = x[i]</span><br><span class="line">            flag += e</span><br><span class="line">    print(&apos;解密时每栏个数:&apos;,step,&apos;\n&apos;,d,&apos;\n&apos;,&apos;result:&apos;,flag)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">待定。。。。</span><br></pre></td></tr></table></figure>

<p>####0x05 不仅仅是Morse<br>“这个题目和我们刚刚做的那个好像啊但是为什么按照刚刚的方法做出来答案却不对呢” ，你奇怪的问了问小鱼，“可能是因为还有一些奇怪的加密方式在里面吧，我们在仔细观察观察”。两个人 安安静静的坐下来开始思考，很耐心的把自己可以想到的加密方式一种种的过了一遍，十多分钟后两个人 异口同声的说“我想到了！”</p>
<p>将<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line"># 密文转化为指定格式</span><br><span class="line">s = &apos;AAAAABAABBBAABBAAAAAAAABAABABAAAAAAABBABAAABBAAABBAABAAAABABAABAAABBABAAABAAABAABABBAABBBABAAABABABBAAABBABAAABAABAABAAAABBABBAABBAABAABAAABAABAABAABABAABBABAAAABBABAABBA&apos;</span><br><span class="line">a = s.lower()</span><br><span class="line"></span><br><span class="line"># 字典</span><br><span class="line">CODE_TABLE = &#123;</span><br><span class="line">    &apos;a&apos;:&apos;aaaaa&apos;,&apos;b&apos;:&apos;aaaab&apos;,&apos;c&apos;:&apos;aaaba&apos;,&apos;d&apos;:&apos;aaabb&apos;,&apos;e&apos;:&apos;aabaa&apos;,&apos;f&apos;:&apos;aabab&apos;,&apos;g&apos;:&apos;aabba&apos;,</span><br><span class="line">    &apos;h&apos;:&apos;aabbb&apos;,&apos;i&apos;:&apos;abaaa&apos;,&apos;j&apos;:&apos;abaab&apos;,&apos;k&apos;:&apos;ababa&apos;,&apos;l&apos;:&apos;ababb&apos;,&apos;m&apos;:&apos;abbaa&apos;,&apos;n&apos;:&apos;abbab&apos;,</span><br><span class="line">    &apos;o&apos;:&apos;abbba&apos;,&apos;p&apos;:&apos;abbbb&apos;,&apos;q&apos;:&apos;baaaa&apos;,&apos;r&apos;:&apos;baaab&apos;,&apos;s&apos;:&apos;baaba&apos;,&apos;t&apos;:&apos;baabb&apos;,&apos;u&apos;:&apos;babaa&apos;,</span><br><span class="line">    &apos;v&apos;:&apos;babab&apos;,&apos;w&apos;:&apos;babba&apos;,&apos;x&apos;:&apos;babbb&apos;,&apos;y&apos;:&apos;bbaaa&apos;,&apos;z&apos;:&apos;bbaab&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 5个一组进行切割并解密</span><br><span class="line">def peigendecode(peigen):</span><br><span class="line">    msg =&apos;&apos;</span><br><span class="line">    codes = re.findall(r&apos;.&#123;5&#125;&apos;, a)</span><br><span class="line">    for code in codes:</span><br><span class="line">        if code ==&apos;&apos;:</span><br><span class="line">            msg += &apos; &apos;</span><br><span class="line">        else:</span><br><span class="line">            UNCODE =dict(map(lambda t:(t[1],t[0]),CODE_TABLE.items()))</span><br><span class="line">            msg += UNCODE[code]</span><br><span class="line">    return msg</span><br><span class="line"></span><br><span class="line">flag = peigendecode(a)</span><br><span class="line">print(&apos;flag is &apos;,flag)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;attackanddefenceworldisinteresting&#125;</span><br></pre></td></tr></table></figure>

<p>####0x06 easy_RSA<br>解答出来了上一个题目的你现在可是春风得意，你们走向了下一个题目所处的地方 你一看这个题目傻眼了，这明明是一个数学题啊！！！可是你的数学并不好。扭头看向小鱼，小鱼哈哈一笑 ，让你在学校里面不好好听讲现在傻眼了吧~来我来！三下五除二，小鱼便把这个题目轻轻松松的搞定了</p>
<ul>
<li>RSA的算法涉及三个参数，n、e、d。<br>其中，n是两个大质数p、q的积，n的二进制表示所占用的位数，就是所谓的密钥长度。<br>e和d是一对相关的值，e可以任意取，但要求e与(p-1)<em>(q-1)互质；再选择d，要求(d*e)mod((p-1)</em>(q-1))=1。<br>（n，e),(n，d)就是密钥对。其中(n，e)为公钥，(n，d)为私钥。<br>RSA加解密的算法完全相同，设A为明文，B为密文，则：A=B^d mod n；B=A^e mod n；（公钥加密体制中，一般用公钥加密，私钥解密）<br>e和d可以互换使用，即：<br>A=B^d mod n；B=A^e mod n</li>
<li>直接给了p,q,e，求d，即为暴力破解<a href="https://www.freebuf.com/articles/others-articles/166049.html" target="_blank" rel="noopener">RSA</a>的私钥之一的d<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = 473398607161</span><br><span class="line">q = 4511491</span><br><span class="line">e = 17</span><br><span class="line"></span><br><span class="line">s = (p-1)*(q-1)</span><br><span class="line">d = gmpy2.invert(e,s)</span><br><span class="line">print(&apos;flag is :&apos;,d)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;125631357777427553&#125;</span><br></pre></td></tr></table></figure>

<p>####0x07 转轮机加密<br>你俩继续往前走，来到了前面的下一个关卡，这个铺面墙上写了好多奇奇怪怪的 英文字母，排列的的整整齐齐，店面前面还有一个大大的类似于土耳其旋转烤肉的架子，上面一圈圈的 也刻着很多英文字母，你是一个小历史迷，对于二战时候的历史刚好特别熟悉，一拍大腿：“嗨呀！我知道 是什么东西了！”</p>
<ul>
<li>转轮机的工作原理<br>每一个旋转轮代表一个单表替代系统，旋转一个引脚，再转变为另一个单表替代系统。为使机器更安全，可把几种转轮和移动的齿轮结合起来。因为所有转轮以不同的速度移动，n个转轮的机器的周期是26的n次方，即n个单表替代系统。最后一个转轮转完一圈之后，它前面的转轮就旋转一个引脚，有点像时钟的齿轮。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">sss = &apos;1: &lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt; 2: &lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt; 3: &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt; 4: &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt; 5: &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt; 6: &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt; 7: &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt; 8: &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt; 9: &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt; 10: &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt; 11 &lt; MNBVCXZQWERTPOIUYALSKDJFHG &lt; 12 &lt; LVNCMXZPQOWEIURYTASBKJDFHG &lt; 13 &lt; JZQAWSXCDERFVBGTYHNUMKILOP &lt;&apos;</span><br><span class="line">m = &apos;NFQKSEVOQOFNP&apos;</span><br><span class="line"># 将sss转化为列表形式</span><br><span class="line">content=re.findall(r&apos;&lt; (.*?) &lt;&apos;,sss,re.S)</span><br><span class="line"># re.S:DOTALL，此模式下，&quot;.&quot;的匹配不受限制，可匹配任何字符，包括换行符</span><br><span class="line">iv=[2,3,7,5,13,12,9,1,8,10,4,11,6]</span><br><span class="line">print(content)</span><br><span class="line">vvv=[]</span><br><span class="line">for i in range(13):</span><br><span class="line">    index=content[iv[i]-1].index(m[i])</span><br><span class="line">    vvv.append(index)</span><br><span class="line">print(vvv)</span><br><span class="line"></span><br><span class="line">for i in range(0,26):</span><br><span class="line">    flag=&quot;&quot;</span><br><span class="line">    for j in range(13):</span><br><span class="line">        flag += content[iv[j]-1][(vvv[j]+i)%26]</span><br><span class="line">    print(flag.lower())</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;fireinthehole&#125;</span><br></pre></td></tr></table></figure>

<p>####0x08 混合编码<br>经过了前面那么多题目的历练，耐心细致在解题当中是 必不可少的品质，刚巧你们都有，你和小鱼越来越入迷。那么走向了下一个题目，这个题目好长 好长，你知道你们只要细心细致，答案总会被你们做出来的，你们开始慢慢的尝试，慢慢的猜想 ，功夫不负有心人，在你们耐心的一步步的解答下，答案跃然纸上，你俩默契一笑，相视击掌 走向了下面的挑战。</p>
<p>多种加密，主要是base64与<a href="https://www.cnblogs.com/kingstarspe/p/ASCII.html" target="_blank" rel="noopener">unicode</a>解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">a = open(r&apos;crypto8.txt&apos;,&apos;r&apos;)</span><br><span class="line">s = a.read()</span><br><span class="line"></span><br><span class="line"># base64解密一下</span><br><span class="line">b = base64.b64decode(s).decode(&apos;ascii&apos;)</span><br><span class="line"># 对解密后的字符串进行处理</span><br><span class="line">b = b.strip(&apos;&amp;#;&apos;)</span><br><span class="line">c = []</span><br><span class="line">c = b.split(&apos;;&amp;#&apos;)</span><br><span class="line"># unicode解密</span><br><span class="line">d = &apos;&apos;</span><br><span class="line">for i in c:</span><br><span class="line">    d += chr(int(i))</span><br><span class="line"># base64再次解密</span><br><span class="line">e = base64.b64decode(d).decode(&apos;ascii&apos;)</span><br><span class="line"># 对字符进行处理</span><br><span class="line">e = e.strip(&apos;/&apos;)</span><br><span class="line">f = []</span><br><span class="line">f = e.split(&apos;/&apos;)</span><br><span class="line"># 转化为ascii码</span><br><span class="line">flag =&apos;&apos;</span><br><span class="line">for i in f:</span><br><span class="line">    flag += chr(int(i))</span><br><span class="line">print(&apos;flag is &apos;,flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;welcometoattackanddefenceworld&#125;</span><br></pre></td></tr></table></figure>

<p>####0x09 Normal_RSA<br>你和小鱼走啊走走啊走，走到下一个题目一看你又一愣，怎么还是一个数学题啊 小鱼又一笑，hhhh数学在密码学里面很重要的！现在知道吃亏了吧！你哼一声不服气，我知道数学 很重要了！但是工具也很重要的，你看我拿工具把他解出来！你打开电脑折腾了一会还真的把答案 做了出来，小鱼有些吃惊，向你投过来一个赞叹的目光</p>
<ul>
<li><a href="https://baike.baidu.com/item/openssl/5454803?fr=aladdin" target="_blank" rel="noopener">OpenSSL</a> 使用 PEM 文件格式存储证书和密钥。PEM 实质上是 Base64 编码的二进制内容，再加上开始和结束行，如证书文件的</li>
</ul>
<p>—–BEGIN CERTIFICATE—–<br>和<br>—–END CERTIFICATE—–<br>在这些标记外面可以有额外的信息，如编码内容的文字表示。文件是 ASCII 的，可以用任何文本编辑程序打开它们。</p>
<ul>
<li>流程：<br>1、openssl提取出pubkey.pem中的参数；<figure class="highlight plain"><figcaption><span>rsa -pubin -text -modulus -in warmup -in pubkey.pem```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;![](https://upload-images.jianshu.io/upload_images/9223646-ecadf140829fa15c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line">2、把hex转decimal后得到十进制数，用yafu进行分解，得到p和q ；</span><br><span class="line">在线：http://www.factordb.com/</span><br><span class="line">```factor()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/9223646-a2088b5d18b8d38a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
</blockquote>
<p>3、用rsatool生成私钥文件: private.pem</p>
<figure class="highlight python"><figcaption><span>rsatool.py -o private.pem -e 65537 -p XXX -q XXX```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;![](https://upload-images.jianshu.io/upload_images/9223646-0a8c5f5133bc0332.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、用private.pem解密flag.enc</span><br><span class="line">```openssl rsautl -decrypt -<span class="keyword">in</span> flag.enc -inkey private.pem</span><br></pre></td></tr></table></figure>

<blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/9223646-769cbef2308676b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PCTF&#123;256b_i5_m3dium&#125;</span><br></pre></td></tr></table></figure>

<p>####0x10 easychallenge<br>你们走到了一个冷冷清清的谜题前面，小鱼看着题目给的信息束手无策，丈二和尚摸不着头脑 ，你嘿嘿一笑，拿出来了你随身带着的笔记本电脑，噼里啪啦的敲起来了键盘，清晰的函数逻辑和流程出现在 了电脑屏幕上，你敲敲键盘，更改了几处地方，运行以后答案变出现在了电脑屏幕上。</p>
<ul>
<li>解释型语言和编译型语言的区别<br>   计算机是不能够识别高级语言的，所以当运行一个高级语言程序时，就需要一个“翻译机”来从事把高级语言转变成计算机能读懂的机器语言的过程。这个过程分成两类，第一种是编译，第二种是解释。<br>  （1）编译型语言：在程序执行之前，先会通过编译器对程序执行一个编译的过程，把程序转变成机器语言。运行时就不需要翻译，而直接执行就可以了。最典型的例子就是C语言。<br>  （2）解释型语言：没有编译的过程，而是在程序运行时，通过解释器对程序逐行解释，然后直接运行，最典型的例子是Ruby。<br>  （3）编译型语言与解释型语言的优缺点：编译型语言在程序运行之前就已经对程序做出了“翻译”，所以在运行时就少掉了“翻译”的过程，所以效率比较高。但是我们也不能一概而论。<br>  （4）先编译后解释的语言：Java首先是通过编译器编译成字节码文件，然后在运行时通过解释器给解释成机器文件。Java等基于虚拟机的语言的存在，我们又不能把语言纯粹地分成解释型和编译型这两种。Python也是一门基于虚拟机的语言。当我们在命令行中输入python hello.py时，其实是激活了Python的“解释器”，告诉“解释器”：你要开始工作了。可是在“解释”之前，其实执行的第一项工作和Java一样，是编译。</li>
<li>Python的运行过程<br>关于PyCodeObject和pyc文件：在硬盘上看到的pyc文件，其实PyCodeObject才是Python编译器真正编译成的结果。当python程序运行时，编译的结果是保存在位于内存中的PyCodeObject中，当Python程序运行结束时，Python解释器则将PyCodeObject写回到pyc文件中。当python程序第二次运行时，首先程序会在硬盘中寻找pyc文件，如果找到，则直接载入，否则就重复上面的过程。所以，我们可以说pyc文件其实是PyCodeObject的一种持久化保存方式。</li>
<li>对于py文件，可以执行下面命令来生成pyc文件。<figure class="highlight python"><figcaption><span>-m foo.py```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">* [.py与.pyc文件区别](https://www.cnblogs.com/zyy98877/p/<span class="number">8650119.</span>html) </span><br><span class="line">原来Python的程序中，是把原始程序代码放在.py文件里，而Python会在执行.py文件的时候。将.py形式的程序编译成中间式文件（byte-compiled）的.pyc文件，这么做的目的就是为了加快下次执行文件的速度。所以，在我们运行python文件的时候，就会自动首先查看是否具有.pyc文件，如果有的话，而且.py文件的修改时间和.pyc的修改时间一样，就会读取.pyc文件，否则，Python就会读原来的.py文件。</span><br><span class="line">其实并不是所有的.py文件在与运行的时候都会产生.pyc文件，只有在<span class="keyword">import</span>相应的.py文件的时候，才会生成相应的.pyc文件</span><br><span class="line">* 给的文件为.pyc文件，先进行反编译为.py文件，再写解密脚本</span><br><span class="line">* 反编译.pyc文件：</span><br><span class="line">·  反编译可以使用uncompyle6或者[在线反编译pyc](https://tool.lu/pyc/)</span><br><span class="line">·  安装uncompyle6 ：pip install uncompyle6</span><br><span class="line">·  反编译命令 uncompyle6 crypto11.pyc</span><br><span class="line">* 反编译结果：</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>#!/usr/bin/env python</p>
<h1 id="encoding-utf-8"><a href="#encoding-utf-8" class="headerlink" title="encoding: utf-8"></a>encoding: utf-8</h1><p>import base64</p>
<p>def encode1(ans):<br>    s = ‘’<br>    for i in ans:<br>        x = ord(i) ^ 36<br>        x = x + 25<br>        s += chr(x)</p>
<pre><code>return s</code></pre><p>def encode2(ans):<br>    s = ‘’<br>    for i in ans:<br>        x = ord(i) + 36<br>        x = x ^ 36<br>        s += chr(x)</p>
<pre><code>return s</code></pre><p>def encode3(ans):<br>    return base64.b32encode(ans)</p>
<p>flag = ‘ ‘<br>print ‘Please Input your flag:’<br>flag = raw_input()<br>final = ‘UC7KOWVXWVNKNIC2XCXKHKK2W5NLBKNOUOSK3LNNVWW3E===’<br>if encode3(encode2(encode1(flag))) == final:<br>    print ‘correct’<br>else:<br>    print ‘wrong’</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 解密脚本</span><br><span class="line">[*涉及python3下ord() expected string of length 1, but int found*](https://www.cnblogs.com/kk328/p/8449794.html)</span><br><span class="line">&gt;![](https://upload-images.jianshu.io/upload_images/9223646-24fedc10e99ec747.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</span><br></pre></td></tr></table></figure>

<p>#!/usr/bin/env python</p>
<h1 id="encoding-utf-8-1"><a href="#encoding-utf-8-1" class="headerlink" title="encoding: utf-8"></a>encoding: utf-8</h1><p>import base64<br>‘’’<br>a = ‘UC7KOWVXWVNKNIC2XCXKHKK2W5NLBKNOUOSK3LNNVWW3E===’<br>b = base64.b32decode(a)<br>‘’’</p>
<h1 id="先将字符串base32解码出来，然后将其变为字符串再进行ord等操作。"><a href="#先将字符串base32解码出来，然后将其变为字符串再进行ord等操作。" class="headerlink" title="先将字符串base32解码出来，然后将其变为字符串再进行ord等操作。"></a>先将字符串base32解码出来，然后将其变为字符串再进行ord等操作。</h1><p>b = “\xa0\xbe\xa7Z\xb7\xb5Z\xa6\xa0Z\xb8\xae\xa3\xa9Z\xb7Z\xb0\xa9\xae\xa3\xa4\xad\xad\xad\xad\xad\xb2”<br>s = ‘’<br>for i in b:<br>    s += chr((ord(i) ^ 36) - 36)<br>l = ‘’<br>for i in s:<br>    l += chr((ord(i) - 25) ^ 36)<br>print (‘flag is ‘,l)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">cyberpeace&#123;interestinghhhhh&#125;</span><br></pre></td></tr></table></figure>

<p>####0x11 幂数加密<br>你和小鱼终于走到了最后的一个谜题所在的地方，上面写着一段话“亲爱的朋友， 很开心你对网络安全有这么大的兴趣，希望你一直坚持下去，不要放弃 ，学到一些知识， 走进广阔的安全大世界”，你和小鱼接过谜题，开始了耐心细致的解答。</p>
<p>(O.A.O)&gt;&gt;给的密文是<a href="http://www.tuili.com/blog/u/503/archives/2009/1200.html" target="_blank" rel="noopener">云影密码</a></p>
<blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/9223646-8e098c3a535e7a0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/user/bin/env python</span><br><span class="line"># -*-coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">a = open(r&apos;crypto11.txt&apos;,&apos;r&apos;)</span><br><span class="line">ciphertext = a.read()</span><br><span class="line"></span><br><span class="line">s = ciphertext.split(&apos;0&apos;)</span><br><span class="line"></span><br><span class="line">flag = &apos;&apos;</span><br><span class="line">for i in range(len(s)):</span><br><span class="line">    list = []</span><br><span class="line">    for j in s[i]:</span><br><span class="line">        list.append(j)</span><br><span class="line">    b = 0</span><br><span class="line">    for k in list:</span><br><span class="line">        b += int(k)</span><br><span class="line">    # 字母ascii值与字母顺序相差为96</span><br><span class="line">    flag += chr(b+96)</span><br><span class="line">print(&apos;flag is &apos;,flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;welldone&#125;</span><br></pre></td></tr></table></figure>

<p>####0x12 easy_ECC<br>转眼两个人又走到了下一个谜题的地方，这又是一种经典的密码学加密方式 而你刚好没有这个的工具，你对小鱼说“小鱼我知道数学真的很重要了，有了工具只是方便我们使用 懂了原理才能做到，小鱼你教我一下这个缇努怎么做吧！”在小鱼的一步步带领下，你终于明白了ECC 的基本原理，成功的解开了这个题目，两个人相视一笑，快步走向了下一个题目所在的位置。</p>
<p><a href="https://blog.csdn.net/dianqu6970/article/details/76534222" target="_blank" rel="noopener">椭圆曲线加密原理</a><br><a href="https://www.cnblogs.com/Kalafinaian/p/7392505.html" target="_blank" rel="noopener">ECC椭圆曲线详解</a><br><a href="https://www.8btc.com/article/15089" target="_blank" rel="noopener">ECC加密算法入门介绍 </a></p>
<ul>
<li>Alice选定一条椭圆曲线E，并取椭圆曲线上一点作为基点G 假设选定E29(4,20)，基点G(13,23) , 基点G的阶数n=37</li>
<li>Alice选择一个私有密钥k（k&lt;n），并生成公开密钥K=kG 比如25, K= kG = 25G = (14,6）</li>
<li>Alice将E和点K、G传给Bob</li>
<li>Bob收到信息后，将待传输的明文编码到上的一点M（编码方法略），并产生一个随机整数r（r&lt;n,n为G的阶数） 假设r=6 要加密的信息为3,因为M也要在E29(4,20) 所以M=(3,28)</li>
<li>Bob计算点C1=M+rK和C2=rG C1= M+6K= M+6<em>25</em>G=M+2G=(3,28)+(27,27)=(6,12) C2=6G=(5,7)</li>
<li>Bob将C1、C2传给Alice</li>
<li>Alice收到信息后，计算C1-kC2，结果就应该是点M C1-kC2 =(6,12)-25C2 =(6,12)-25*6G =(6,12)-2G =(6,12)-(27,27) =(6,12)+(27,2) =(3,28)</li>
</ul>
<p><em>数学原来上能解密是因为:C1-kC2=M+rK-krG=M+rkG-krG-M</em><br><a href="https://www.jianshu.com/p/b99cb35733c8" target="_blank" rel="noopener">参考</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"></span><br><span class="line">def get_inverse(mu, p):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    获取y的负元</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    for i in range(1, p):</span><br><span class="line">        if (i*mu)%p == 1:</span><br><span class="line">            return i</span><br><span class="line">    return -1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_gcd(zi, mu):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    获取最大公约数</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    if mu:</span><br><span class="line">        return get_gcd(mu, zi%mu)</span><br><span class="line">    else:</span><br><span class="line">        return zi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_np(x1, y1, x2, y2, a, p):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    获取n*p，每次+p，直到求解阶数np=-p</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    flag = 1  # 定义符号位（+/-）</span><br><span class="line"></span><br><span class="line">    # 如果 p=q  k=(3x2+a)/2y1mod p</span><br><span class="line">    if x1 == x2 and y1 == y2:</span><br><span class="line">        zi = 3 * (x1 ** 2) + a  # 计算分子      【求导】</span><br><span class="line">        mu = 2 * y1    # 计算分母</span><br><span class="line"></span><br><span class="line">    # 若P≠Q，则k=(y2-y1)/(x2-x1) mod p</span><br><span class="line">    else:</span><br><span class="line">        zi = y2 - y1</span><br><span class="line">        mu = x2 - x1</span><br><span class="line">        if zi* mu &lt; 0:</span><br><span class="line">            flag = 0        # 符号0为-（负数）</span><br><span class="line">            zi = abs(zi)</span><br><span class="line">            mu = abs(mu)</span><br><span class="line"></span><br><span class="line">    # 将分子和分母化为最简</span><br><span class="line">    gcd_value = get_gcd(zi, mu)     # 最大公約數</span><br><span class="line">    zi = zi // gcd_value            # 整除</span><br><span class="line">    mu = mu // gcd_value</span><br><span class="line">    # 求分母的逆元  逆元： ∀a ∈G ，ョb∈G 使得 ab = ba = e</span><br><span class="line">    # P(x,y)的负元是 (x,-y mod p)= (x,p-y) ，有P+(-P)= O∞</span><br><span class="line">    inverse_value = get_inverse(mu, p)</span><br><span class="line">    k = (zi * inverse_value)</span><br><span class="line"></span><br><span class="line">    if flag == 0:                   # 斜率负数 flag==0</span><br><span class="line">        k = -k</span><br><span class="line">    k = k % p</span><br><span class="line">    # 计算x3,y3 P+Q</span><br><span class="line">    x3 = (k ** 2 - x1 - x2) % p</span><br><span class="line">    y3 = (k * (x1 - x3) - y1) % p</span><br><span class="line">    return x3,y3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_rank(x0, y0, a, b, p):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    获取椭圆曲线的阶</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    x1 = x0             #-p的x坐标</span><br><span class="line">    y1 = (-1*y0)%p      #-p的y坐标</span><br><span class="line">    tempX = x0</span><br><span class="line">    tempY = y0</span><br><span class="line">    n = 1</span><br><span class="line">    while True:</span><br><span class="line">        n += 1</span><br><span class="line">        # 求p+q的和，得到n*p，直到求出阶</span><br><span class="line">        p_x,p_y = get_np(tempX, tempY, x0, y0, a, p)</span><br><span class="line">        # 如果 == -p,那么阶数+1，返回</span><br><span class="line">        if p_x == x1 and p_y == y1:</span><br><span class="line">            return n+1</span><br><span class="line">        tempX = p_x</span><br><span class="line">        tempY = p_y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_param(x0, a, b, p):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    计算p与-p</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    y0 = -1</span><br><span class="line">    for i in range(p):</span><br><span class="line">        # 满足取模约束条件，椭圆曲线Ep(a,b)，p为质数，x,y∈[0,p-1]</span><br><span class="line">        if i**2%p == (x0**3 + a*x0 + b)%p:</span><br><span class="line">            y0 = i</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    # 如果y0没有，返回false</span><br><span class="line">    if y0 == -1:</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    # 计算-y（负数取模）</span><br><span class="line">    x1 = x0</span><br><span class="line">    y1 = (-1*y0) % p</span><br><span class="line">    return x0,y0,x1,y1</span><br><span class="line"></span><br><span class="line">def get_ng(G_x, G_y, key, a, p):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    计算nG</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    temp_x = G_x</span><br><span class="line">    temp_y = G_y</span><br><span class="line">    while key != 1:</span><br><span class="line">        temp_x,temp_y = get_np(temp_x,temp_y, G_x, G_y, a, p)</span><br><span class="line">        key -= 1</span><br><span class="line">    return temp_x,temp_y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def ecc_main():</span><br><span class="line">    while True:</span><br><span class="line">        a = int(input(&quot;请输入椭圆曲线参数a(a&gt;0)的值：&quot;))</span><br><span class="line">        b = int(input(&quot;请输入椭圆曲线参数b(b&gt;0)的值：&quot;))</span><br><span class="line">        p = int(input(&quot;请输入椭圆曲线参数p(p为素数)的值：&quot;))   #用作模运算</span><br><span class="line"></span><br><span class="line">        # 条件满足判断</span><br><span class="line">        if (4*(a**3)+27*(b**2))%p == 0:</span><br><span class="line">            print(&quot;您输入的参数有误，请重新输入！！！\n&quot;)</span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    # 选点作为G点</span><br><span class="line">    print(&quot;在如上坐标系中选一个值为G的坐标&quot;)</span><br><span class="line">    G_x = int(input(&quot;请输入选取的x坐标值：&quot;))</span><br><span class="line">    G_y = int(input(&quot;请输入选取的y坐标值：&quot;))</span><br><span class="line"></span><br><span class="line">    # 获取椭圆曲线的阶</span><br><span class="line">    n = get_rank(G_x, G_y, a, b, p)</span><br><span class="line"></span><br><span class="line">    # user1生成私钥，小key</span><br><span class="line">    key = int(input(&quot;请输入私钥小key（&lt;&#123;&#125;）：&quot;.format(n)))</span><br><span class="line"></span><br><span class="line">    # user1生成公钥，大KEY</span><br><span class="line">    KEY_x,kEY_y = get_ng(G_x, G_y, key, a, p)</span><br><span class="line">    print(&apos;flag is &apos;,KEY_,KEY_Y)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    ecc_main()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p有点大，跑不动</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/zz_Caleb/article/details/87016017" target="_blank" rel="noopener">https://blog.csdn.net/zz_Caleb/article/details/87016017</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i> CTF</a>
          
            <a href="/tags/攻防世界/" rel="tag"><i class="fa fa-tag"></i> 攻防世界</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/09/14/Web/upload-labs/" rel="next" title="upload-labs">
                <i class="fa fa-chevron-left"></i> upload-labs
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/09/14/LInux/wargame--bandit/" rel="prev" title="wargame-bandit">
                wargame-bandit <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/blog-logo.jpg" alt="hf1dw">
            
              <p class="site-author-name" itemprop="name">hf1dw</p>
              <p class="site-description motion-element" itemprop="description">Good habits are more important than hard work</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">43</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">40</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hf1dw" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/41daca7ad841" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-heartbeat"></i></a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart[object Object]"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">©2019 by hf1dw</span>

  
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
